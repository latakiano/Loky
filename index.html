<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LOKY ADVENTURE - Ù…ØºØ§Ù…Ø±Ø© Ø§Ù„Ø¨Ø·Ù„</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: 'Cairo', sans-serif; }
        #ui { position: absolute; top: 10px; width: 100%; text-align: center; color: white; pointer-events: none; z-index: 10; }
        .hero-msg { color: #f1c40f; font-size: 18px; font-weight: bold; animation: glow 1s infinite alternate; }
        .score-box { font-size: 45px; font-weight: bold; color: #00f2fe; }
        @keyframes glow { from { text-shadow: 0 0 5px #f1c40f; } to { text-shadow: 0 0 20px #f39c12; } }
    </style>
</head>
<body>

    <div id="ui">
        <div class="hero-msg">Ø·Ø±ÙŠÙ‚Ùƒ Ø£Ù„ØºØ§Ù….. Ù„ÙƒÙ† Ø¹Ù†Ø¯Ùƒ ÙƒÙ†ÙˆØ² Ø§Ù‚Ø·ÙÙ‡Ø§!</div>
        <div id="lvlLab" style="color:#00f2fe">Ø§Ù„Ù…Ø±Ø­Ù„Ø©: 1</div>
        <div id="scrLab" class="score-box">0</div>
        <div style="color:#f1c40f">ğŸ’° ÙƒÙ†ÙˆØ²Ùƒ: <span id="coinLab">0</span></div>
    </div>

    <audio id="bgMusic" loop>
        <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
    </audio>

    <canvas id="gameCanvas"></canvas>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const music = document.getElementById('bgMusic');
    
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    let bird = { x: 50, y: canvas.height/2, w: 30, h: 40, v: 0, g: 0.6, j: -9 };
    let pipes = [];
    let coins = [];
    let score = 0;
    let totalCoins = 0;
    let level = 1;
    let speed = 4;
    let active = true;
    let win = false;
    let musicStarted = false;

    const colors = ["#ff4757", "#2ed573", "#1e90ff", "#ffa502", "#5352ed", "#ff6b81"];

    function createPipe() {
        let gap = Math.max(160, 210 - (level * 2.5));
        let top = Math.random() * (canvas.height - gap - 120) + 60;
        pipes.push({ x: canvas.width, t: top, g: gap, p: false, color: colors[level % colors.length] });
        
        // Ø§Ù„ÙƒÙ†ÙˆØ² (Ø§Ù„Ø¬ÙˆØ§Ø¦Ø²)
        if (Math.random() > 0.4) {
            coins.push({ x: canvas.width + 25, y: top + gap/2, r: 12, c: false });
        }
    }

    function draw() {
        // Ø®Ù„ÙÙŠØ© ØªØªØºÙŠØ± ÙÙŠ Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø£Ø®ÙŠØ±Ø©
        ctx.fillStyle = (level >= 20) ? "#300" : "#111";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        if (win) {
            ctx.fillStyle = "rgba(0,0,0,0.8)"; ctx.fillRect(0,0,canvas.width,canvas.height);
            ctx.fillStyle = "#f1c40f"; ctx.font = "bold 40px Arial"; ctx.textAlign = "center";
            ctx.fillText("ğŸ† Ø®Ø° Ø§Ù„ÙƒØ£Ø³ ÙŠØ§ Ø¨Ø·Ù„!", canvas.width/2, canvas.height/2);
            ctx.font = "20px Arial"; ctx.fillText("Ø£Ù†Øª Ù…ØºØ§Ù…Ø± Ø­Ù‚ÙŠÙ‚ÙŠ ÙˆØ®ØªÙ…Øª Ø§Ù„Ù„Ø¹Ø¨Ø©!", canvas.width/2, canvas.height/2 + 50);
            return;
        }

        // Ø±Ø³Ù… Ø§Ù„Ø¨Ø·Ù„ (Ø§Ù„Ø¥Ù†Ø³Ø§Ù†)
        ctx.fillStyle = "#FFDBAC"; ctx.fillRect(bird.x + 5, bird.y, 20, 20); // Ø§Ù„Ø±Ø£Ø³
        ctx.fillStyle = "#1e90ff"; ctx.fillRect(bird.x, bird.y + 20, 30, 20); // Ø§Ù„Ù‚Ù…ÙŠØµ

        // Ø±Ø³Ù… Ø§Ù„Ø£Ù„ØºØ§Ù… (Ø§Ù„Ø­ÙˆØ§Ø¬Ø²)
        pipes.forEach((p, i) => {
            p.x -= speed;
            ctx.fillStyle = p.color;
            ctx.fillRect(p.x, 0, 60, p.t);
            ctx.fillRect(p.x, p.t + p.g, 60, canvas.height);
            
            // ØªØµØ§Ø¯Ù…
            if (bird.x < p.x + 60 && bird.x + 30 > p.x && (bird.y < p.t || bird.y + 40 > p.t + p.g)) active = false;
            
            if (!p.p && p.x < bird.x) {
                score++; p.p = true; document.getElementById('scrLab').innerText = score;
                if (score % 5 === 0) {
                    level++; speed += 0.4; 
                    document.getElementById('lvlLab').innerText = "Ø§Ù„Ù…Ø±Ø­Ù„Ø©: " + level;
                }
                if (level > 20) win = true;
            }
            if (p.x + 60 < 0) pipes.splice(i, 1);
        });

        // Ø±Ø³Ù… Ø§Ù„ÙƒÙ†ÙˆØ²
        coins.forEach((c, i) => {
            c.x -= speed;
            if (!c.c) {
                ctx.fillStyle = "#f1c40f"; ctx.beginPath();
                ctx.arc(c.x, c.y, c.r, 0, Math.PI*2); ctx.fill();
                ctx.fillStyle = "#000"; ctx.font = "12px Arial"; ctx.fillText("â­", c.x-6, c.y+5);
            }
            let dx = bird.x - c.x; let dy = bird.y - c.y;
            if (!c.c && Math.sqrt(dx*dx + dy*dy) < 35) {
                c.c = true; totalCoins++; document.getElementById('coinLab').innerText = totalCoins;
            }
            if (c.x + 20 < 0) coins.splice(i, 1);
        });

        if (active) {
            bird.v += bird.g; bird.y += bird.v;
            if (bird.y > canvas.height || bird.y < 0) active = false;
            if (pipes.length === 0 || pipes[pipes.length-1].x < canvas.width - 280) createPipe();
            requestAnimationFrame(draw);
        } else {
            ctx.fillStyle = "rgba(0,0,0,0.7)"; ctx.fillRect(0,0,canvas.width,canvas.height);
            ctx.fillStyle = "white"; ctx.font = "25px Arial"; ctx.textAlign = "center";
            ctx.fillText("Ù‡ÙŠØ§ ÙŠØ§ Ø¨Ø·Ù„.. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰!", canvas.width/2, canvas.height/2);
            ctx.font = "15px Arial"; ctx.fillText("Ø§Ù„Ù…Ø³ Ø§Ù„Ø´Ø§Ø´Ø© Ù„Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø±", canvas.width/2, canvas.height/2 + 50);
        }
    }

    function reset() {
        bird.y = canvas.height/2; bird.v = 0; pipes = []; coins = []; score = 0; level = 1; speed = 4;
        active = true; win = false; document.getElementById('scrLab').innerText = "0";
        document.getElementById('lvlLab').innerText = "Ø§Ù„Ù…Ø±Ø­Ù„Ø©: 1"; draw();
    }

    function handleAction() {
        if (!musicStarted) { music.play(); musicStarted = true; }
        if (!active || win) reset(); else bird.v = bird.j;
    }

    window.addEventListener('mousedown', handleAction);
    window.addEventListener('touchstart', (e) => { e.preventDefault(); handleAction(); }, {passive: false});

    createPipe();
    draw();
</script>
</body>
</html>