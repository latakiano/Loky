<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ØªØ­Ø¯ÙŠ Ø§Ù„Ù€ 20 Ù…Ø±Ø­Ù„Ø© - LOKY</title>
    <style>
        body { margin: 0; padding: 0; overflow: hidden; background: #1a1a1a; font-family: Arial; }
        canvas { display: block; }
        #ui {
            position: absolute; top: 10px; width: 100%; text-align: center;
            color: #fff; pointer-events: none; text-shadow: 2px 2px 4px #000;
        }
        .level-text { color: #f1c40f; font-size: 20px; }
        .score-text { color: #00f2fe; font-size: 40px; font-weight: bold; }
    </style>
</head>
<body>
    <div id="ui">
        <div class="level-text" id="levelDisplay">Ø§Ù„Ù…Ø±Ø­Ù„Ø©: 1</div>
        <div class="score-text" id="scoreBoard">0</div>
    </div>
    <canvas id="game"></canvas>

<script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const scoreDisplay = document.getElementById('scoreBoard');
    const levelDisplay = document.getElementById('levelDisplay');

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    let bird = { x: 50, y: canvas.height/2, w: 30, h: 40, v: 0, g: 0.6, jump: -9 };
    let pipes = [];
    let score = 0;
    let level = 1;
    let gameSpeed = 4;
    let running = true;
    let won = false;

    function createPipe() {
        let gap = 200 - (level * 2); // Ø§Ù„ÙØªØ­Ø© ØªØ¶ÙŠÙ‚ Ù‚Ù„ÙŠÙ„Ø§Ù‹ ÙƒÙ„ Ù…Ø±Ø­Ù„Ø©
        let top = Math.random() * (canvas.height - gap - 100) + 50;
        pipes.push({ x: canvas.width, top: top, gap: gap, passed: false });
    }

    function drawHuman(x, y) {
        ctx.fillStyle = "#FFDBAC"; ctx.fillRect(x + 5, y, 20, 20); // Ø±Ø£Ø³
        ctx.fillStyle = "#3498db"; ctx.fillRect(x, y + 20, 30, 20); // Ø¬Ø³Ù…
    }

    function update() {
        if (!running || won) return;
        bird.v += bird.g;
        bird.y += bird.v;

        if (bird.y + bird.h > canvas.height || bird.y < 0) running = false;

        if (pipes.length === 0 || pipes[pipes.length - 1].x < canvas.width - 280) createPipe();

        pipes.forEach((p, i) => {
            p.x -= gameSpeed;
            if (bird.x < p.x + 55 && bird.x + bird.w > p.x && (bird.y < p.top || bird.y + bird.h > p.top + p.gap)) running = false;
            
            if (!p.passed && p.x < bird.x) {
                score++;
                scoreDisplay.innerText = score;
                p.passed = true;
                
                // Ù†Ø¸Ø§Ù… Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¨ÙŠÙ† Ø§Ù„Ù…Ø±Ø§Ø­Ù„ (ÙƒÙ„ 5 Ù†Ù‚Ø§Ø· Ù…Ø±Ø­Ù„Ø©)
                if (score % 5 === 0) {
                    level++;
                    if (level > 20) { won = true; }
                    else {
                        levelDisplay.innerText = "Ø§Ù„Ù…Ø±Ø­Ù„Ø©: " + level;
                        gameSpeed += 0.5; // Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø³Ø±Ø¹Ø©
                    }
                }
            }
            if (p.x + 60 < 0) pipes.splice(i, 1);
        });
    }

    function draw() {
        ctx.fillStyle = '#1a1a1a';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        
        if (won) {
            drawWinScreen();
            return;
        }

        drawHuman(bird.x, bird.y);
        ctx.fillStyle = '#2ecc71';
        pipes.forEach(p => {
            ctx.fillRect(p.x, 0, 55, p.top);
            ctx.fillRect(p.x, p.top + p.gap, 55, canvas.height);
        });

        update();
        if (running) {
            requestAnimationFrame(draw);
        } else {
            drawGameOver();
        }
    }

    function drawWinScreen() {
        ctx.fillStyle = "rgba(0,0,0,0.8)";
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = "#f1c40f";
        ctx.font = "60px Arial"; ctx.textAlign = "center";
        ctx.fillText("ðŸ†", canvas.width/2, canvas.height/2 - 50);
        ctx.font = "30px Arial";
        ctx.fillText("Ù…Ø¨Ø±ÙˆÙƒ! Ø§Ø³ØªÙ„Ù…Øª Ø§Ù„ÙƒØ£Ø³", canvas.width/2, canvas.height/2 + 20);
        ctx.font = "18px Arial";
        ctx.fillText("Ù„Ù‚Ø¯ Ø®ØªÙ…Øª Ø§Ù„Ù€ 20 Ù…Ø±Ø­Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­", canvas.width/2, canvas.height/2 + 60);
    }

    function drawGameOver() {
        ctx.fillStyle = "rgba(0,0,0,0.7)";
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = "white";
        ctx.font = "25px Arial"; ctx.textAlign = "center";
        ctx.fillText("Ø®Ø³Ø±Øª ÙÙŠ Ø§Ù„Ù…Ø±Ø­Ù„Ø© " + level, canvas.width/2, canvas.height/2);
        ctx.fillText("Ø§Ù„Ù…Ø³ Ù„Ù„Ø¥Ø¹Ø§Ø¯Ø©", canvas.width/2, canvas.height/2 + 50);
    }

    function reset() {
        bird.y = canvas.height/2; bird.v = 0; pipes = []; score = 0; level = 1; gameSpeed = 4;
        scoreDisplay.innerText = 0; levelDisplay.innerText = "Ø§Ù„Ù…Ø±Ø­Ù„Ø©: 1"; running = true; won = false; draw();
    }

    window.addEventListener('touchstart', (e) => { e.preventDefault(); if(!running || won) reset(); else bird.v = bird.jump; }, {passive: false});
    window.addEventListener('mousedown', () => { if(!running || won) reset(); else bird.v = bird.jump; });

    draw();
</script>
</body>
</html>