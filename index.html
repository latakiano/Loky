<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Himalayan Cat Adventure</title>
    <style>
        body { margin: 0; overflow: hidden; background: #050505; font-family: sans-serif; touch-action: none; }
        #ui { position: absolute; top: 10px; width: 100%; text-align: center; color: #fff; z-index: 100; pointer-events: none; }
        .progress-bar { width: 70%; height: 12px; background: #222; margin: 10px auto; border-radius: 6px; border: 2px solid #444; overflow: hidden; }
        #fill { width: 0%; height: 100%; background: linear-gradient(90deg, #ff416c, #00ff00); transition: width 0.2s; }
        .info { font-size: 18px; color: #f1c40f; text-shadow: 2px 2px 4px #000; font-weight: bold; }
    </style>
</head>
<body>

<div id="ui">
    <div class="info">Ø§Ù‡Ø±Ø¨ Ù†Ø­Ùˆ Ø¨ÙŠØª Ø§Ù„Ø£Ù…Ø§Ù†! ğŸ¾</div>
    <div class="progress-bar"><div id="fill"></div></div>
    <div style="font-size: 14px;">Ø§Ù„Ù…Ø³Ø§ÙØ© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: <span id="dist">1500</span>m</div>
</div>

<canvas id="game"></canvas>

<script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    
    function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resize);
    resize();

    // ØªØ­Ù…ÙŠÙ„ ØµÙˆØ±Ø© Ø§Ù„Ù‚Ø·Ø©
    const catImg = new Image();
    catImg.src = 'https://i.imgur.com/WBy6v9S.png'; 

    let player = { x: 100, y: canvas.height/2, w: 45, h: 40, v: 0, g: 0.45, j: -8 };
    let monsterX = -200;
    let obstacles = [], distance = 1500, active = true, win = false, gameStarted = false;
    let speed = 5;
    let obstacleCount = 0;

    const columnColors = ["#FFFF00", "#0000FF", "#FF0000", "#008000", "#000080", "#8B4513", "#50C878", "#4B0082", "#000000"];

    function createObstacle() {
        if (1500 - distance < 300) return; 
        let gap = 220; 
        let top = Math.random() * (canvas.height - gap - 150) + 70;
        let color = columnColors[obstacleCount % columnColors.length];
        obstacles.push({ x: canvas.width, t: top, g: gap, color: color });
        obstacleCount++;
    }

    function update() {
        if (!active || win || !gameStarted) return;

        player.v += player.g;
        player.y += player.v;
        distance -= 1.5;
        monsterX = Math.min(player.x - 40, monsterX + 0.4);

        document.getElementById('dist').innerText = Math.max(0, Math.floor(distance));
        document.getElementById('fill').style.width = (1 - distance/1500)*100 + "%";

        if (distance <= 0) win = true;

        if (obstacles.length === 0 || obstacles[obstacles.length-1].x < canvas.width - 350) {
            createObstacle();
        }

        for (let i = obstacles.length - 1; i >= 0; i--) {
            let p = obstacles[i];
            p.x -= speed;
            
            // ØªØµØ§Ø¯Ù…
            if (player.x < p.x + 60 && player.x + player.w > p.x && 
               (player.y < p.t || player.y + player.h > p.t + p.g)) {
                active = false;
            }
            if (p.x + 60 < 0) obstacles.splice(i, 1);
        }

        if (player.y > canvas.height || player.y < 0 || player.x <= monsterX) active = false;
    }

    function draw() {
        ctx.fillStyle = "#0a0a0a";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // Ø±Ø³Ù… Ø§Ù„ÙˆØ­Ø´
        ctx.fillStyle = "rgba(255, 0, 0, 0.2)";
        ctx.beginPath(); 
        ctx.arc(monsterX - 60, player.y + 20, 100, 0, Math.PI*2); 
        ctx.fill();

        // Ø±Ø³Ù… Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©
        obstacles.forEach(p => {
            ctx.fillStyle = p.color;
            ctx.fillRect(p.x, 0, 60, p.t);
            ctx.fillRect(p.x, p.t + p.g, 60, canvas.height);
        });

        // Ø±Ø³Ù… Ø§Ù„Ù‚Ø·Ø©
        ctx.drawImage(catImg, player.x, player.y, player.w, player.h);

        if (win) {
            ctx.fillStyle = "rgba(255,255,255,0.95)"; ctx.fillRect(0,0,canvas.width,canvas.height);
            ctx.fillStyle = "#2ecc71"; ctx.font = "bold 30px Arial"; ctx.textAlign="center";
            ctx.fillText("ğŸ¡ ÙˆØµÙ„Øª Ù„Ø¨ÙŠØª Ø§Ù„Ø£Ù…Ø§Ù†! ğŸ†", canvas.width/2, canvas.height/2);
        } else if (!active) {
            ctx.fillStyle = "rgba(0,0,0,0.85)"; ctx.fillRect(0,0,canvas.width,canvas.height);
            ctx.fillStyle = "#ff4444"; ctx.font = "bold 25px Arial"; ctx.textAlign="center";
            ctx.fillText("Ø£Ù…Ø³Ùƒ Ø¨Ùƒ Ø§Ù„ÙˆØ­Ø´! Ø§Ù„Ù…Ø³ Ù„Ù„Ø¥Ø¹Ø§Ø¯Ø©", canvas.width/2, canvas.height/2);
        } else if (!gameStarted) {
            ctx.fillStyle = "white"; ctx.textAlign="center"; ctx.font = "20px Arial";
            ctx.fillText("Ø§Ù„Ù…Ø³ Ø§Ù„Ø´Ø§Ø´Ø© Ù„Ù„Ø§Ù†Ø·Ù„Ø§Ù‚ ğŸ¾", canvas.width/2, canvas.height/2);
        }

        update();
        requestAnimationFrame(draw);
    }

    function reset() {
        player.y = canvas.height/2; player.v = 0; monsterX = -200; 
        obstacles = []; distance = 1500; active = true; win = false; 
        gameStarted = false; obstacleCount = 0;
    }

    const action = (e) => {
        if (e.type === 'touchstart') e.preventDefault();
        if (!active || win) reset(); else { gameStarted = true; player.v = player.j; }
    };
    
    window.addEventListener('mousedown', action);
    window.addEventListener('touchstart', action, {passive: false});

    draw();
</script>
</body>
</html>