<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LOKY - الإنسان الطائر</title>
    <style>
        body { margin: 0; padding: 0; overflow: hidden; background: #000; }
        canvas { display: block; }
        #score {
            position: absolute; top: 10px; width: 100%; text-align: center;
            color: #00f2fe; font-family: Arial; font-size: 35px; font-weight: bold;
            pointer-events: none; text-shadow: 2px 2px 4px #000;
        }
    </style>
</head>
<body>
    <div id="score">0</div>
    <canvas id="game"></canvas>

<script>
    // بداية البرمجة - كل شيء هنا يجب أن يكون ملوناً في محررك
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const scoreDisplay = document.getElementById('score');

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    let human = { x: 50, y: canvas.height/2, w: 30, h: 40, v: 0, g: 0.6, jump: -10 };
    let pipes = [];
    let score = 0;
    let running = true;

    function createPipe() {
        let gap = 200;
        let top = Math.random() * (canvas.height - gap - 100) + 50;
        pipes.push({ x: canvas.width, top: top, bottom: canvas.height - top - gap, passed: false });
    }

    function drawHuman(x, y) {
        // رسم شخصية بسيطة (رأس وجسم)
        ctx.fillStyle = "#FFDBAC"; // الرأس
        ctx.fillRect(x + 5, y, 20, 20);
        ctx.fillStyle = "#3498db"; // الجسم
        ctx.fillRect(x, y + 20, 30, 20);
    }

    function update() {
        if (!running) return;
        human.v += human.g;
        human.y += human.v;

        if (human.y + human.h > canvas.height || human.y < 0) running = false;

        if (pipes.length === 0 || pipes[pipes.length - 1].x < canvas.width - 280) createPipe();

        pipes.forEach((p, i) => {
            p.x -= 4;
            // اصطدام
            if (human.x < p.x + 50 && human.x + human.w > p.x && (human.y < p.top || human.y + human.h > canvas.height - p.bottom)) running = false;
            // نقاط
            if (!p.passed && p.x < human.x) { score++; scoreDisplay.innerText = score; p.passed = true; }
            if (p.x + 50 < 0) pipes.splice(i, 1);
        });
    }

    function draw() {
        ctx.fillStyle = '#1a1a1a';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        
        drawHuman(human.x, human.y);

        ctx.fillStyle = '#2ecc71'; // لون الأعمدة
        pipes.forEach(p => {
            ctx.fillRect(p.x, 0, 50, p.top);
            ctx.fillRect(p.x, canvas.height - p.bottom, 50, p.bottom);
        });

        update();
        if (running) {
            requestAnimationFrame(draw);
        } else {
            ctx.fillStyle = 'white';
            ctx.font = '25px Arial';
            ctx.textAlign = 'center';
            ctx.fillText("جيم أوفر! المس لإعادة المحاولة", canvas.width/2, canvas.height/2);
        }
    }

    function reset() {
        human.y = canvas.height/2; human.v = 0; pipes = []; score = 0; scoreDisplay.innerText = 0; running = true; draw();
    }

    window.addEventListener('touchstart', (e) => { e.preventDefault(); if(!running) reset(); else human.v = human.jump; }, {passive: false});
    window.addEventListener('mousedown', () => { if(!running) reset(); else human.v = human.jump; });

    draw();
</script>
</body>
</html>