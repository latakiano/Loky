<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Himalayan Horror Cave</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: sans-serif; }
        #ui { position: absolute; top: 10px; width: 100%; text-align: center; color: #ff3333; z-index: 20; pointer-events: none; }
        .score { font-size: 40px; font-weight: bold; text-shadow: 0 0 10px #ff0000; }
        .msg { color: #f1c40f; font-size: 18px; text-shadow: 2px 2px 4px #000; }
    </style>
</head>
<body>

<div id="ui">
    <div class="msg">Ø£Ù†Øª ÙÙŠ ÙƒÙ‡Ù Ø§Ù„Ø£Ù„ØºØ§Ù….. Ø®Ø° Ø§Ù„ÙƒÙ†ÙˆØ² ÙŠØ§ Ø¨Ø·Ù„! ğŸ†</div>
    <div class="score" id="scr">0</div>
    <div style="color:#f1c40f">ğŸ’° Level: <span id="lvl">1</span> | Coins: <span id="cns">0</span></div>
</div>

<canvas id="game"></canvas>

<script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    // ØµÙˆØ±Ø© Ø§Ù„Ù‚Ø·Ø© Ø§Ù„Ù‡ÙŠÙ…Ø§Ù„Ø§ÙŠØ§ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ©
    const catImg = new Image();
    catImg.src = 'https://i.imgur.com/WBy6v9S.png'; 

    let bird = { x: 50, y: canvas.height/2, w: 70, h: 60, v: 0, g: 0.5, j: -8 };
    let pipes = [], coins = [], redEyes = [], score = 0, totalCoins = 0, level = 1, speed = 4.5, active = true, win = false;

    // Ø¥Ù†Ø´Ø§Ø¡ Ø¹ÙŠÙˆÙ† Ø­Ù…Ø±Ø§Ø¡ Ù…Ø±Ø¹Ø¨Ø© ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ©
    function createEyes() {
        redEyes.push({ x: canvas.width + Math.random()*200, y: Math.random()*canvas.height, opacity: 1 });
    }

    function createPipe() {
        let gap = Math.max(140, 210 - (level * 3));
        let top = Math.random() * (canvas.height - gap - 120) + 60;
        pipes.push({ x: canvas.width, t: top, g: gap, p: false });
        if (Math.random() > 0.4) coins.push({ x: canvas.width + 30, y: top + gap/2, r: 12, col: false });
        if (Math.random() > 0.7) createEyes();
    }

    function draw() {
        // Ø®Ù„ÙÙŠØ© Ø§Ù„ÙƒÙ‡Ù Ø§Ù„Ù…Ø¸Ù„Ù…Ø©
        ctx.fillStyle = (level >= 20) ? "#200" : "#0a0a0a";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // Ø±Ø³Ù… Ø§Ù„Ø¹ÙŠÙˆÙ† Ø§Ù„Ø­Ù…Ø±Ø§Ø¡ Ø§Ù„Ù…Ø±Ø¹Ø¨Ø©
        redEyes.forEach((e, i) => {
            e.x -= speed * 0.5;
            ctx.fillStyle = `rgba(255, 0, 0, ${Math.sin(Date.now()/200)})`;
            ctx.beginPath(); ctx.arc(e.x, e.y, 3, 0, Math.PI*2); ctx.fill();
            ctx.beginPath(); ctx.arc(e.x + 15, e.y, 3, 0, Math.PI*2); ctx.fill();
            if (e.x < -20) redEyes.splice(i, 1);
        });

        if (win) {
            ctx.fillStyle = "rgba(0,0,0,0.85)"; ctx.fillRect(0,0,canvas.width,canvas.height);
            ctx.fillStyle = "#f1c40f"; ctx.font = "bold 30px Arial"; ctx.textAlign="center";
            ctx.fillText("ğŸ† Ø®Ø° Ø§Ù„ÙƒØ£Ø³ ÙŠØ§ Ø¨Ø·Ù„!", canvas.width/2, canvas.height/2);
            return;
        }

        // Ø±Ø³Ù… Ø§Ù„Ù‚Ø·Ø© Ø§Ù„Ù‡ÙŠÙ…Ø§Ù„Ø§ÙŠØ§ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ©
        ctx.drawImage(catImg, bird.x, bird.y, bird.w, bird.h);

        // Ø±Ø³Ù… ØµØ®ÙˆØ± Ø§Ù„ÙƒÙ‡Ù (Ø§Ù„Ø£Ù„ØºØ§Ù…)
        pipes.forEach((p, i) => {
            p.x -= speed;
            ctx.fillStyle = "#333";
            ctx.fillRect(p.x, 0, 60, p.t); // ØµØ®ÙˆØ± Ø¹Ù„ÙˆÙŠØ©
            ctx.fillRect(p.x, p.t + p.g, 60, canvas.height); // ØµØ®ÙˆØ± Ø³ÙÙ„ÙŠØ©
            
            // ØªØµØ§Ø¯Ù…
            if (bird.x < p.x + 60 && bird.x + bird.w > p.x && (bird.y < p.t || bird.y + bird.h > p.t + p.g)) active = false;
            
            if (!p.p && p.x < bird.x) {
                score++; p.p = true; document.getElementById('scr').innerText = score;
                if (score % 5 === 0) { level++; speed += 0.5; document.getElementById('lvl').innerText = level; }
                if (level >= 20) win = true;
            }
            if (p.x + 60 < 0) pipes.splice(i, 1);
        });

        // Ø±Ø³Ù… Ø§Ù„ÙƒÙ†ÙˆØ²
        coins.forEach((c, i) => {
            c.x -= speed;
            if (!c.col) {
                ctx.fillStyle = "#FFD700"; ctx.beginPath(); ctx.arc(c.x, c.y, c.r, 0, Math.PI*2); ctx.fill();
                if (Math.abs(bird.x - c.x) < 45 && Math.abs(bird.y - c.y) < 45) { c.col = true; totalCoins++; document.getElementById('cns').innerText = totalCoins; }
            }
            if (c.x + 20 < 0) coins.splice(i, 1);
        });

        if (active) {
            bird.v += bird.g; bird.y += bird.v;
            if (bird.y > canvas.height || bird.y < 0) active = false;
            if (pipes.length === 0 || pipes[pipes.length-1].x < canvas.width - 280) createPipe();
            requestAnimationFrame(draw);
        } else {
            ctx.fillStyle = "rgba(0,0,0,0.7)"; ctx.fillRect(0,0,canvas.width,canvas.height);
            ctx.fillStyle = "#fff"; ctx.font = "20px Arial"; ctx.textAlign="center";
            ctx.fillText("Ø³Ù‚Ø· Ø§Ù„Ø¨Ø·Ù„! Ø§Ù„Ù…Ø³ Ø§Ù„Ø´Ø§Ø´Ø© Ù„Ù„Ù†Ù‡ÙˆØ¶ Ù…Ø¬Ø¯Ø¯Ø§Ù‹", canvas.width/2, canvas.height/2);
        }
    }

    function reset() {
        bird.y = canvas.height/2; bird.v = 0; pipes = []; coins = []; redEyes = []; score = 0; level = 1; speed = 4.5; active = true; win = false; draw();
    }

    const play = () => { if(!active || win) reset(); else bird.v = bird.j; };
    window.addEventListener('mousedown', play);
    window.addEventListener('touchstart', (e) => { e.preventDefault(); play(); }, {passive: false});

    createPipe();
    draw();
</script>
</body>
</html>