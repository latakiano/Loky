<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Himalayan Cat Real Adventure</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: sans-serif; }
        #gameUI { position: absolute; top: 15px; width: 100%; text-align: center; color: #ff3333; z-index: 50; pointer-events: none; }
        .score-val { font-size: 50px; font-weight: bold; text-shadow: 0 0 15px #ff0000; color: #fff; }
        .hero-label { color: #f1c40f; font-size: 18px; letter-spacing: 1px; background: rgba(0,0,0,0.4); padding: 5px; border-radius: 8px; }
    </style>
</head>
<body>

<div id="gameUI">
    <div class="hero-label">Ø£Ù†Øª Ø¨Ø·Ù„ ÙŠØ§ Ù…ØºØ§Ù…Ø±.. Ø§Ù„Ù‚Ø·Ø© ØªØ«Ù‚ Ø¨Ùƒ! ğŸ†</div>
    <div class="score-val" id="scoreDisplay">0</div>
    <div style="color:#f1c40f; font-weight:bold;">Level: <span id="lvlDisplay">1</span> | ğŸ’°: <span id="coinDisplay">0</span></div>
</div>

<canvas id="mainCanvas"></canvas>

<script>
    const canvas = document.getElementById('mainCanvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    // ØµÙˆØ±Ø© Ø§Ù„Ù‚Ø·Ø© Ø§Ù„Ù‡ÙŠÙ…Ø§Ù„Ø§ÙŠØ§ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ© (Ø±Ø§Ø¨Ø· Ù„ØµÙˆØ±Ø© Ø­Ù‚ÙŠÙ‚ÙŠØ©)
    const catSprite = new Image();
    catSprite.src = 'https://i.imgur.com/WBy6v9S.png'; 

    let player = { x: 60, y: canvas.height/2, w: 80, h: 70, velocity: 0, gravity: 0.5, jumpPower: -9 };
    let obstacles = [], treasures = [], redEyes = [], score = 0, coins = 0, currentLevel = 1, moveSpeed = 5, isGameOver = false, isVictory = false;

    // Ø¯Ø§Ù„Ø© Ù„Ø®Ù„Ù‚ Ø¹ÙŠÙˆÙ† Ø­Ù…Ø±Ø§Ø¡ Ù…Ø±Ø¹Ø¨Ø© Ø®Ù„Ù Ø§Ù„Ù‚Ø·Ø©
    function addScaryEyes() {
        redEyes.push({ x: canvas.width + 50, y: Math.random() * canvas.height, size: 3 + Math.random() * 3 });
    }

    function spawnObstacle() {
        let gapSize = Math.max(150, 220 - (currentLevel * 3));
        let topH = Math.random() * (canvas.height - gapSize - 120) + 60;
        obstacles.push({ x: canvas.width, top: topH, gap: gapSize, isPassed: false });
        
        if (Math.random() > 0.4) treasures.push({ x: canvas.width + 40, y: topH + gapSize/2, radius: 14, collected: false });
        if (Math.random() > 0.6) addScaryEyes();
    }

    function render() {
        // Ø±Ø³Ù… Ø§Ù„ÙƒÙ‡Ù Ø§Ù„Ù…Ø¸Ù„Ù… Ø¨ØªØ¯Ø±Ø¬ Ù…Ø®ÙŠÙ
        let caveGrad = ctx.createLinearGradient(0, 0, 0, canvas.height);
        caveGrad.addColorStop(0, '#050505');
        caveGrad.addColorStop(1, (currentLevel >= 15) ? '#300000' : '#151515');
        ctx.fillStyle = caveGrad;
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // ØªØ­Ø±ÙŠÙƒ ÙˆØ±Ø³Ù… Ø§Ù„Ø¹ÙŠÙˆÙ† Ø§Ù„Ø­Ù…Ø±Ø§Ø¡
        redEyes.forEach((eye, index) => {
            eye.x -= moveSpeed * 0.4;
            ctx.fillStyle = `rgba(255, 0, 0, ${Math.abs(Math.sin(Date.now()/500))})`;
            ctx.beginPath(); ctx.arc(eye.x, eye.y, eye.size, 0, Math.PI*2); ctx.fill();
            ctx.beginPath(); ctx.arc(eye.x + 18, eye.y, eye.size, 0, Math.PI*2); ctx.fill();
            if (eye.x < -30) redEyes.splice(index, 1);
        });

        if (isVictory) {
            ctx.fillStyle = "rgba(0,0,0,0.9)"; ctx.fillRect(0,0,canvas.width,canvas.height);
            ctx.fillStyle = "#f1c40f"; ctx.font = "bold 35px Arial"; ctx.textAlign="center";
            ctx.fillText("ğŸ† Ù…Ø¨Ø±ÙˆÙƒ ÙŠØ§ Ø¨Ø·Ù„! Ù†Ù„Øª Ø§Ù„ÙƒØ£Ø³", canvas.width/2, canvas.height/2);
            return;
        }

        // Ø±Ø³Ù… Ø§Ù„Ù‚Ø·Ø© Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ© (Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©)
        ctx.drawImage(catSprite, player.x, player.y, player.w, player.h);

        // Ø±Ø³Ù… ØµØ®ÙˆØ± Ø§Ù„ÙƒÙ‡Ù (Ø§Ù„Ø£Ù„ØºØ§Ù…)
        obstacles.forEach((obs, i) => {
            obs.x -= moveSpeed;
            ctx.fillStyle = "#2c2c2c";
            ctx.fillRect(obs.x, 0, 70, obs.top); // ØµØ®Ø± Ø¹Ù„ÙˆÙŠ
            ctx.fillRect(obs.x, obs.top + obs.gap, 70, canvas.height); // ØµØ®Ø± Ø³ÙÙ„ÙŠ
            
            // ÙƒØ´Ù Ø§Ù„Ø§ØµØ·Ø¯Ø§Ù…
            if (player.x < obs.x + 70 && player.x + player.w > obs.x && (player.y < obs.top || player.y + player.h > obs.top + obs.gap)) isGameOver = true;
            
            if (!obs.isPassed && obs.x < player.x) {
                score++; obs.isPassed = true;
                document.getElementById('scoreDisplay').innerText = score;
                if (score % 5 === 0) {
                    currentLevel++; moveSpeed += 0.6;
                    document.getElementById('lvlDisplay').innerText = currentLevel;
                }
                if (currentLevel >= 20) isVictory = true;
            }
            if (obs.x + 70 < 0) obstacles.splice(i, 1);
        });

        // Ø±Ø³Ù… Ø§Ù„ÙƒÙ†ÙˆØ² (Ø§Ù„Ø¬ÙˆØ§Ø¦Ø²)
        treasures.forEach((coin, i) => {
            coin.x -= moveSpeed;
            if (!coin.collected) {
                ctx.fillStyle = "#FFD700"; ctx.beginPath(); ctx.arc(coin.x, coin.y, coin.radius, 0, Math.PI*2); ctx.fill();
                ctx.fillStyle = "#fff"; ctx.font = "bold 12px Arial"; ctx.fillText("â­", coin.x-6, coin.y+5);
                if (Math.abs(player.x - coin.x) < 50 && Math.abs(player.y - coin.y) < 50) {
                    coin.collected = true; coins++;
                    document.getElementById('coinDisplay').innerText = coins;
                }
            }
            if (coin.x + 20 < 0) treasures.splice(i, 1);
        });

        if (!isGameOver) {
            player.velocity += player.gravity;
            player.y += player.velocity;
            if (player.y > canvas.height || player.y < 0) isGameOver = true;
            if (obstacles.length === 0 || obstacles[obstacles.length-1].x < canvas.width - 320) spawnObstacle();
            requestAnimationFrame(render);
        } else {
            ctx.fillStyle = "rgba(0,0,0,0.7)"; ctx.fillRect(0,0,canvas.width,canvas.height);
            ctx.fillStyle = "#fff"; ctx.font = "24px Arial"; ctx.textAlign="center";
            ctx.fillText("Ø³Ù‚Ø· Ø§Ù„Ø¨Ø·Ù„! Ø§Ù„Ù…Ø³ Ø§Ù„Ø´Ø§Ø´Ø© Ù„Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø«Ø§Ù†ÙŠØ©", canvas.width/2, canvas.height/2);
        }
    }

    function restartGame() {
        player.y = canvas.height/2; player.velocity = 0; obstacles = []; treasures = []; redEyes = []; 
        score = 0; coins = 0; currentLevel = 1; moveSpeed = 5; isGameOver = false; isVictory = false;
        document.getElementById('scoreDisplay').innerText = "0";
        document.getElementById('lvlDisplay').innerText = "1";
        document.getElementById('coinDisplay').innerText = "0";
        render();
    }

    const handleInput = (e) => { 
        if(e.type === 'touchstart') e.preventDefault();
        if(isGameOver || isVictory) restartGame(); else player.velocity = player.jumpPower; 
    };
    window.addEventListener('mousedown', handleInput);
    window.addEventListener('touchstart', handleInput, {passive: false});

    spawnObstacle();
    render();
</script>
</body>
</html>