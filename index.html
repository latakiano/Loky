<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LOKY - ØªØ­Ø¯ÙŠ Ø§Ù„ÙƒØ£Ø³ ÙˆØ§Ù„Ø¹Ù…Ù„Ø§Øª</title>
    <style>
        body { margin: 0; overflow: hidden; background: #1a1a1a; font-family: Arial; }
        #ui { position: absolute; top: 10px; width: 100%; text-align: center; color: #fff; pointer-events: none; }
        .coin-text { color: #f1c40f; font-size: 20px; font-weight: bold; }
    </style>
</head>
<body>
    <div id="ui">
        <div id="levelDisplay" style="color: #00f2fe;">Ø§Ù„Ù…Ø±Ø­Ù„Ø©: 1</div>
        <div id="scoreBoard" style="font-size: 40px; font-weight: bold;">0</div>
        <div class="coin-text">ğŸª™ Ø§Ù„Ø¹Ù…Ù„Ø§Øª: <span id="coinCount">0</span></div>
    </div>
    <canvas id="game"></canvas>

<script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const scoreDisplay = document.getElementById('scoreBoard');
    const levelDisplay = document.getElementById('levelDisplay');
    const coinDisplay = document.getElementById('coinCount');

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    let bird = { x: 50, y: canvas.height/2, w: 30, h: 40, v: 0, g: 0.6, jump: -9 };
    let pipes = [];
    let coins = [];
    let score = 0;
    let totalCoins = 0;
    let level = 1;
    let gameSpeed = 4;
    let running = true;
    let won = false;

    // Ù…ØµÙÙˆÙØ© Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ù„Ù„Ù…Ø±Ø§Ø­Ù„
    const levelColors = ["#2ecc71", "#e74c3c", "#9b59b6", "#3498db", "#e67e22", "#f1c40f", "#1abc9c", "#d35400"];

    function createPipe() {
        let gap = 200 - (level * 2);
        let top = Math.random() * (canvas.height - gap - 100) + 50;
        let pipeX = canvas.width;
        pipes.push({ x: pipeX, top: top, gap: gap, passed: false });
        
        // Ø¥Ø¶Ø§ÙØ© Ø¬Ø§Ø¦Ø²Ø© (Ø¹Ù…Ù„Ø©) ÙÙŠ Ù…Ù†ØªØµÙ Ø§Ù„ÙØªØ­Ø© Ø¨Ù†Ø³Ø¨Ø© 70%
        if (Math.random() > 0.3) {
            coins.push({ x: pipeX + 25, y: top + gap/2, r: 10, collected: false });
        }
    }

    function drawHuman(x, y) {
        ctx.fillStyle = "#FFDBAC"; ctx.fillRect(x + 5, y, 20, 20); // Ø±Ø£Ø³
        ctx.fillStyle = "#3498db"; ctx.fillRect(x, y + 20, 30, 20); // Ø¬Ø³Ù…
    }

    function update() {
        if (!running || won) return;
        bird.v += bird.g;
        bird.y += bird.v;

        if (bird.y + bird.h > canvas.height || bird.y < 0) running = false;

        if (pipes.length === 0 || pipes[pipes.length - 1].x < canvas.width - 280) createPipe();

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­ÙˆØ§Ø¬Ø²
        pipes.forEach((p, i) => {
            p.x -= gameSpeed;
            if (bird.x < p.x + 55 && bird.x + bird.w > p.x && (bird.y < p.top || bird.y + bird.h > p.top + p.gap)) running = false;
            if (!p.passed && p.x < bird.x) {
                score++; scoreDisplay.innerText = score; p.passed = true;
                if (score % 5 === 0) {
                    level++;
                    if (level > 20) won = true;
                    else { levelDisplay.innerText = "Ø§Ù„Ù…Ø±Ø­Ù„Ø©: " + level; gameSpeed += 0.4; }
                }
            }
            if (p.x + 60 < 0) pipes.splice(i, 1);
        });

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù…Ù„Ø§Øª
        coins.forEach((c, i) => {
            c.x -= gameSpeed;
            // ÙƒØ´Ù Ø¬Ù…Ø¹ Ø§Ù„Ø¹Ù…Ù„Ø©
            let dx = bird.x + bird.w/2 - c.x;
            let dy = bird.y + bird.h/2 - c.y;
            let distance = Math.sqrt(dx * dx + dy * dy);
            if (!c.collected && distance < 30) {
                c.collected = true;
                totalCoins++;
                coinDisplay.innerText = totalCoins;
            }
            if (c.x + 20 < 0) coins.splice(i, 1);
        });
    }

    function draw() {
        // ØªØºÙŠÙŠØ± Ù„ÙˆÙ† Ø§Ù„Ø®Ù„ÙÙŠØ© ÙÙŠ Ø§Ù„Ù…Ø±Ø­Ù„Ø© 20
        ctx.fillStyle = (level >= 20) ? '#4d0000' : '#1a1a1a';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        
        if (won) { drawWinScreen(); return; }

        // Ø±Ø³Ù… Ø§Ù„Ø¹Ù…Ù„Ø§Øª
        coins.forEach(c => {
            if (!c.collected) {
                ctx.fillStyle = "#f1c40f";
                ctx.beginPath();
                ctx.arc(c.x, c.y, c.r, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = "#fff";
                ctx.fillText("$", c.x - 4, c.y + 5);
            }
        });

        drawHuman(bird.x, bird.y);

        // Ø±Ø³Ù… Ø§Ù„Ø­ÙˆØ§Ø¬Ø² Ø¨Ù„ÙˆÙ† Ø§Ù„Ù…Ø±Ø­Ù„Ø©
        ctx.fillStyle = levelColors[level % levelColors.length];
        pipes.forEach(p => {
            ctx.fillRect(p.x, 0, 55, p.top);
            ctx.fillRect(p.x, p.top + p.gap, 55, canvas.height);
        });

        update();
        if (running) requestAnimationFrame(draw);
        else drawGameOver();
    }

    function drawWinScreen() {
        ctx.fillStyle = "rgba(0,0,0,0.8)";
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = "#f1c40f"; ctx.font = "60px Arial"; ctx.textAlign = "center";
        ctx.fillText("ğŸ†", canvas.width/2, canvas.height/2 - 50);
        ctx.font = "25px Arial";
        ctx.fillText("Ù…Ø¨Ø±ÙˆÙƒ! Ø®ØªÙ…Øª Ø§Ù„Ù„Ø¹Ø¨Ø© ÙˆØªÙˆØ¬Øª Ø¨Ø§Ù„ÙƒØ£Ø³", canvas.width/2, canvas.height/2 + 20);
        ctx.fillText("Ø¬Ù…Ø¹Øª " + totalCoins + " Ø¹Ù…Ù„Ø© Ø°Ù‡Ø¨ÙŠØ©!", canvas.width/2, canvas.height/2 + 60);
    }

    function drawGameOver() {
        ctx.fillStyle = "rgba(0,0,0,0.7)";
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = "white"; ctx.font = "25px Arial"; ctx.textAlign = "center";
        ctx.fillText("Ø®Ø³Ø±Øª ÙÙŠ Ø§Ù„Ù…Ø±Ø­Ù„Ø© " + level, canvas.width/